<!DOCTYPE html>
<html>
  <head>
	<script src="https://d3js.org/d3.v5.min.js"></script>
	<script src="https://unpkg.com/d3-simple-slider"></script>

	<link
	  rel="stylesheet"
	  href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
	  integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
	  crossorigin="anonymous"
	/>

  </head>
<body>
 	<div class="ui-box" style='border-style: solid; border-width: 2px; width: 370px; border-color: #a3a3a3' >
    	<div class="col-sm-2">
    		<p id="value-range"></p>
    	</div>
    	<div class="col-sm">
    		<div id="slider-range">
    		</div>
    	</div>
    
    	<!-- The checkbox amenitites -->
    	<div class="check-boxes">	
	    	<input type="checkbox" class="myCheckbox" value="parks"> Parks
	   		<input type="checkbox" class="myCheckbox" value="police"> Police Stations
	   		<input type="checkbox" class="myCheckbox" value="schools"> Schools
	   		<input type="checkbox" class="myCheckbox" value="health-clinics"> Health Clinics		
  		</div>
  	
	</div>

	<script>

		//NOTE: To get current range, use "range" array.
		//  	To get current checked boxes, use "checked" array.

		var checked = []; //holds current checkedboxes
		var range = []; //holds the current range

		//TODO: "dataSlider" needs to be replaced with actual max rent price and min rent price.
		var dataSlider = [1200, 3500];

		myText = d3.select(".ui-box")
			.append("text")
			.attr('font-size', '14')
			.attr('id', "textline")
  			;


		var sliderRange = d3
		   .sliderBottom()
		   .min(d3.min(dataSlider))
		   .max(d3.max(dataSlider))
		   .width(250)
	       .tickFormat(d3.format('.02s'))
	       .ticks(5)
	       .default([2000, 2500])
	       .fill('#2196f3')
	       .on('onchange', val => {
		      d3.select('p#value-range')
		      	.text("Price Range: From " + val.map(d3.format('.02s'))
		      	.join(' to '));
		      	range = val;
		    });

		var gRange = d3
		   .select('div#slider-range')
		   .append('svg')
		   .attr('width', 500)
		   .attr('height', 100)
		   .append('g')
		   .attr('transform', 'translate(30,30)');

		gRange.call(sliderRange);

		//Configues the price range text above slider only at initialization
		d3.select('p#value-range').text("Price Range: From " + sliderRange
		   .value()
		   .map(d3.format('.02s'))
		   .join(' to ')
		);


		//on click event handling for checkboxes
		d3.selectAll(".myCheckbox")
			.on("change", update);

		// update(): this gets what boxes have been checked. It sends back what boxes are checked every time a checkbox has been clicked/unclicked
		function update() {
			var choices = [];
			d3.selectAll(".myCheckbox").each(function(d){
          		cb = d3.select(this);
          		if(cb.property("checked")){
          			if (cb.property)
          				choices.push(cb.property("value"));
          		} 
          		
          		d3.select("#textline")
          			 	.text(choices);
        	});
        	checked = choices;
		}


	</script>

</body>
</html>