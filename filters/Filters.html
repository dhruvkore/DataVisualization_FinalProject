<!DOCTYPE html>
<html>
  <head>
	<script src="https://d3js.org/d3.v5.min.js"></script>
	<script src="https://unpkg.com/d3-simple-slider"></script>

	<link
	  rel="stylesheet"
	  href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
	  integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
	  crossorigin="anonymous"
	/>

	<link rel="stylesheet" type="text/css" href="./filters.css"/>


  </head>
<body>
 	<div class="ui-box" style='border-style: solid; border-width: 2px; width: 370px; border-color: #a3a3a3' >
    	<div class="priceRange">
    		<h6 align="center">Price Range</h6>
    		<p id="value-range"></p>
    	</div>

    	<div class="col-sm">
    		<div id="slider-range">
    		</div>
    	</div>

    	<div class="SATSlider">
    		<h6 align= "center">SAT Score Range</h6>
    		<p id ="SAT-range"></p>
    	</div>


    
    	<!-- The checkbox amenitites -->
    	<div class="check-boxes" >	
    		<h6 align="center">Amenities</h6>
    		<label class ="container">Parks
	    		<input type="checkbox" class="myCheckbox" value="parks"/> 
	    		<span class="checkmark"></span>
	    	</label>
	   		<label class ="container">Police Stations
	   			<input type="checkbox" class="myCheckbox" value="police"> 
	   			<span class="checkmark"></span>
	   		</label>
	   		<label class ="container">Schools
	   			<input type="checkbox" class="myCheckbox" value="schools">
	   			<span class="checkmark"></span>
	   		</label>
	   		<label class ="container">Health Clinics
	   			<input type="checkbox" class="myCheckbox" value="health-clinics">	
	   			<span class="checkmark"></span>
	   		</label>
  		</div>
  	
	</div>

	<script>

		//NOTE: To get current range, use "range" array.
		//  	To get current checked boxes, use "checked" array.

		var checked = []; //holds current checkedboxes
		var pricerange = []; //holds the current range
		var SATrannge = [];

		//TODO: "dataSlider" needs to be replaced with actual max rent price and min rent price.
		var dataSlider = [1200, 3500];

		myText = d3.select(".ui-box")
			.append("text")
			.attr('font-size', '12')
			.attr('id', "textline")
  			;


		var sliderRange = d3
		   .sliderBottom()
		   .min(d3.min(dataSlider))
		   .max(d3.max(dataSlider))
		   .width(250)
	       .tickFormat(d3.format('.02s'))
	       .ticks(5)
	       .default([2000, 2500])
	       .fill('#2196f3')
	       .on('onchange', val => {
		      d3.select('p#value-range')
		      	.text("From " + val.map(d3.format('.02s'))
		      	.join(' to '))
		      	pricerange = val;
		    });

		var gRange = d3
		   .select('div#slider-range')
		   .append('svg')
		   .attr('width', 500)
		   .attr('height', 90)
		   .append('g')
		   .attr('transform', 'translate(30,30)');

		gRange.call(sliderRange);

		//Configues the price range text above slider only at initialization
		d3.select('p#value-range').text("From " + sliderRange
		   .value()
		   .map(d3.format('.02s'))
		   .join(' to ')
		);


		//on click event handling for checkboxes
		d3.selectAll(".myCheckbox")
			.on("change", update);

		// update(): this gets what boxes have been checked. It sends back what boxes are checked every time a checkbox has been clicked/unclicked
		function update() {
			var choices = [];
			d3.selectAll(".myCheckbox").each(function(d){
          		cb = d3.select(this);
          		if(cb.property("checked")){
          			if (cb.property)
          				choices.push(cb.property("value"));
          		} 

          		//The line of text is for testing: makes sure the right boxes are being triggered
          		d3.select("#textline")
          			 	.text(choices);
        	});
        	checked = choices;
		}

		//SAT Slider Code:
		var dataSliderSAT = [400, 1600];

		var sliderRangeSAT = d3
		   .sliderBottom()
		   .min(d3.min(dataSliderSAT))
		   .max(d3.max(dataSliderSAT))
		   .width(250)
	       .tickFormat(d3.format('.02s'))
	       .ticks(5)
	       .default([1000, 1300])
	       .fill('#2196f3')
	       .on('onchange', val => {
		      d3.select('p#value-range')
		      	.text("From " + val.map(d3.format('.02s'))
		      	.join(' to '))
		      	SATrange = val;
		    });

		var gRangeSAT = d3
		   .select('div#slider-range')
		   .append('svg')
		   .attr('width', 500)
		   .attr('height', 90)
		   .append('g')
		   .attr('transform', 'translate(30,30)');

		gRangeSAT.call(sliderRangeSAT);

		//Configues the price range text above slider only at initialization
		d3.select('p#value-range').text("From " + sliderRangeSAT
		   .value()
		   .map(d3.format('.02s'))
		   .join(' to ')
		);


	</script>

</body>
</html>